openapi: "3.1.0"
info:
  title: IWXXM SIGMET Model
  version: "1.0"
  description: |
    An OpenAPI model of the IWXXM SIGMET diagram.

components:
  schemas:
    VolcanicAshSIGMET:
      description: A SIGMET that reports the presence of volcanic ash conditions hazardous to flight.
      allOf:
        - $ref: "#/components/schemas/SIGMET"
        - type: object
          properties:
            eruptingVolcano:
              $ref: "../Meteorological_Feature/Property_Types.yaml#/components/schemas/Volcano"
            volcanicAshMovedToFIR:
              $ref: "../AIXM/AIXM.yaml#/components/schemas/Airspace"

    TropicalCycloneSIGMET:
      description: A SIGMET that reports the presence of a tropical cyclone conditions.
      allOf:
        - $ref: "#/components/schemas/SIGMET"
        - type: object
          properties:
            supplementaryAnalysisCollection:
              type: array
              uniqueItems: true
              items:
                $ref: "#/components/schemas/AnalysisAndForecastPositionAnalysis"
            tropicalCyclone:
              $ref: "../Meteorological_Feature/Property_Types.yaml#/components/schemas/TropicalCyclone"

    SIGMET:
      description: A SIGMET (significant meteorological) report. SIGMETs report the occurrence and/or expected occurrence of specified en-route weather phenomena which may affect the safety of aircraft operations, and of the development of those phenomena over time.
      type: object
      required:
        - issueTime
        - issuingAirTrafficServicesUnit
        - validPeriod
      properties:
        issueTime:
          $ref: "../GML/GML.yaml#/components/schemas/TimeInstant"
        issuingAirTrafficServicesUnit:
          $ref: "../AIXM/AIXM.yaml#/components/schemas/Unit"
        originatingMeteorologicalWatchOffice:
          $ref: "../AIXM/AIXM.yaml#/components/schemas/Unit"
        issuingAirTrafficServicesRegion:
          $ref: "../AIXM/AIXM.yaml#/components/schemas/Airspace"
        sequenceNumber:
          $ref: "../Common/String.yaml#/components/schemas/StringWithNilReason"
        validPeriod:
          $ref: "../GML/GML.yaml#/components/schemas/TimePeriod"
        cancelledReportSequenceNumber:
          $ref: "../Common/String.yaml#/components/schemas/CharacterString"
        cancelledReportValidPeriod:
          $ref: "../GML/GML.yaml#/components/schemas/TimePeriod"
        phenomenon:
          $ref: "#/components/schemas/AeronauticalSignificantWeatherPhenomenon"
        analysisCollection:
          type: array
          uniqueItems: true
          items:
            $ref: "#/components/schemas/AnalysisAndForecastPositionAnalysis"
        isCancelReport:
          type: string
          enum: ["CNL"]

    AeronauticalSignificantWeatherPhenomenon:
      description: |
        Weather phenomenon of significance to aviation operations; used in SIGMET and AIRMET reports. 

        http://codes.wmo.int/49-2/SigWxPhenomena
      type: string
      enum: []

    AnalysisAndForecastPositionAnalysis:
      description: Conditions observed and/or forecast of the SIGMET phenomenon.
      type: object
      properties:
        analysis:
          $ref: "SIGMET_Analysis.yaml#/components/schemas/SIGMETEvolvingConditionCollection"
        forecastPositionAnalysis:
          $ref: "SIGMET_Forecast_Position_Analysis.yaml#/components/schemas/SIGMETPositionCollection"
